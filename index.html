<html>
	<head>
		<script src="js/mail-generator.js"></script>
		<link href="css/style.css" rel="stylesheet" media="screen">
    <script>
      window.onload = function(){

        function loadPage(array) {
          for(var i=0; i<geemails.length;i++) {//go through email array
            outputEmail(array[i],i);  ////create email line

            //back button functionality to email window
            var back = document.getElementById("backButton");
            back.addEventListener("click",showList);

            document.getElementById("inboxCounter").innerHTML = geemails.length;
          }
        }
        function showList() {
          //hide email window
          var messageShow = document.getElementById("messageDisplay");
          messageShow.style.display = "none"; 
          //show email list
          var messageList = document.getElementById("mailDisplay");
          messageList.style.display = "flex";

        }

        function outputEmail(mailObj, arrayId) { //put together email, put on display
          var message = document.createElement("div");
          message.className = "email";
          var sender = emailSection("sender", mailObj);
          message.appendChild(sender);
          var subject = emailSection("subject", mailObj);
          message.appendChild(subject);            
          var date = emailSection("date", mailObj);
          message.appendChild(date);

          var id = document.createElement("div");
          id.className = "arrayId";
          id.innerHTML = arrayId;
          message.appendChild(id);

          message.addEventListener("click",showMessage);
          //append message to mailDisplay, on webpage
          mailDisplay.appendChild(message);
        }

        function emailSection(string, arrayPos) {  //generate sections of the email
          var section = document.createElement("div");
          section.className = string;
          section.innerHTML = arrayPos[string];
          return section;
        }

        function showMessage() { //display email body when clicked
          //show email in main window, hide email list
          var messageWindow =document.getElementById("messageDisplay");
          var messageList =document.getElementById("mailDisplay");
          
          messageWindow.style.display = "flex";
          messageList.style.display = "none";

          //get info to display email
          var subject = this.querySelector(".subject").innerHTML;
          var sender = this.querySelector(".sender").innerHTML;
          var date = this.querySelector(".date").innerHTML;
          var bodyId = this.querySelector(".arrayId").innerHTML;
          var body = geemails[bodyId].body;

          //display email in appropriate window
          document.getElementById("emailSubject").innerHTML = subject;
          document.getElementById("emailSender").innerHTML = sender;
          document.getElementById("emailDate").innerHTML = date;
          document.getElementById("emailContents").innerHTML = body;
        }


        function newMessage() {  //generate new email?
          var message = getNewMessage(); //generate email
          //console.log("message",message); //check contents
          geemails.push(message); //add new email to end of geemails array
          outputEmail(message,(geemails.length - 1));
          //console.log(geemails.length); //how many emails now?
        }

        function refreshInbox() {
          var inboxCounter = document.getElementById("inboxCounter");
          console.log(typeof inboxCounter);
          if(inboxCounter.innerHTML !== geemails.length) {
            inboxCounter.innerHTML = geemails.length;
            console.log("different");
          } else {
            console.log("same");
          }
        }



//functions being called
        loadPage(geemails);
        setInterval(newMessage,6000); //generate new email at set intervals
        setInterval(refreshInbox,1000); //refresh inbox counter
        
      };
    </script>
	</head>
	<body>
		<div class="container" id="main">
      <header>
        <div id="title">
          <h1> Gee-Mail</h1>
        </div>
        <div id="inboxCounter">
          
        </div>
      </header>
      
      <div id="mailDisplay">
      </div>
      <div id="messageDisplay">
        <div id="emailHeader">
          <img src="" alt="back" id="backButton">
          <p id="emailSubject">you listen</p>
        </div>
        <div id="emailInfo">
          <div id="emailSender">me</div>
          <div id="emailDate">4/7/2017</div>
        </div>
        <div id="emailContents">
          
        </div>

      </div>
      
      <footer>
        <p>the footer</p>  
      </footer>
		</div>
	</body>
</html>

